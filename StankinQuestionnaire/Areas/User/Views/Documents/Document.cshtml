@model long
@{
    ViewBag.Title = "Документ";
}
<script>
    documentID=@Model;
</script>
@section scripts{
    @Scripts.Render("~/bundles/Angular")
    <script src="~/Scripts/Сontrollers/Services.js"></script>
    <script src="~/Scripts/Сontrollers/document.js"></script>
    <script src="~/Scripts/Сontrollers/filters.js"></script>
}
<div ng-app="documents">
    <div ng-controller="DocumentType">
        <div ng-repeat="indicatorGroup in document.IndicatorGroups" class="indicator-group container">
            <div class="row indicator-group-row">
                <h2 class="col-md-6">{{indicatorGroup.Name}}</h2>
                <span class="col-md-6 "> Максимальное количество баллов: {{indicatorGroup.MaxPoint}}</span>
            </div>
            <div ng-repeat="indicator in indicatorGroup.Indicators" class="indicator row">
                <h4 class="col-md-6"> {{indicator.Name}}</h4>
                <div class="col-md-6">
                    <div ng-repeat="calculationType in indicator.CalculationTypes" class="calculation-type">
                        <button type="button" ng-click="btnAdd(calculationType.UnitName,calculationType.CalculationTypeID)" class="btn btn-success btn-xs">
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                        </button>   {{calculationType.Point}} баллов - {{calculationType.UnitName}} <a href="" ng-click="viewCalculations(calculationType)">{{calculationType.Calculations.length | viewLength}}</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="add-calculation" @*ng-show="visivbleAddForm"*@ tabindex="-1" role="dialog" aria-labelledby="title" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="title">"{{addForm.title}}"</h4>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-danger alert-dismissible" ng-hide="addError" id="error-alert" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <strong>На сервере произошла ошибка!</strong> <span id="error-text"></span>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="calculationDescription">Описание</label>
                            <div class="col-sm-10">
                                <textarea id="calculationDescription" name="Description" class="form-control" ng-model="addForm.description" rows="3"></textarea>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                        <button type="button" class="btn btn-primary ladda-button" data-size="xs" data-style="expand-left" ng-click="saveAdd()" id="btnSaveEdit"><span class="ladda-label">Сохранить</span></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="view-calculation" tabindex="-1" role="dialog" aria-labelledby="title" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="title">Просмотр</h4>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-success alert-dismissible" ng-hide="updateSuccess" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <strong>Успешно сохранено!</strong> <span id="error-text"></span>
                        </div>
                        <div class="alert alert-success alert-dismissible" ng-hide="deleteSuccess" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <strong>Успешно удален!</strong> <span id="error-text"></span>
                        </div>
                        <div class="alert alert-danger alert-dismissible" ng-hide="updateError" id="error-alert" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <strong>На сервере произошла ошибка!</strong> <span id="error-text"></span>
                        </div>
                        <div class="form-group">
                            <div ng-repeat="calculation in currentCalculations" class="row center-align view-calculation">
                                <textarea name="Description" class="col-md-9 view-calculation-description" ng-model="calculation.Description" rows="3"></textarea>
                                <div class="view-calculation-btns">
                                    <button type="button" class="btn btn-success" ng-click="saveCalculation(calculation)"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span> Сохранить</button>
                                    <button type="button" class="btn btn-danger" ng-click="deleteCalculation(calculation)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Удалить</button>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Отмена</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>